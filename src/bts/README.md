## 线程同步基础 (basic thread synchronization)

多个执行线程共享一个资源的情景，是最常见的并发编程情景之一。

在并发应用中常常遇到这样的场景：多个线程读/写相同的数据，或者访问相同的文件或数据库连接。
为了防止这些共享资源有可能出现的错误或数据不一致，我们必须实现一些机制来防止这些错误的发生。

为了解决这些问题，人们引入了临界区（Critical Section）概念。

临界区是一个用以访问共享资源的代码块，这个代码块在同一时间内只允许一个线程执行。

为了帮助编程人员实现这个临界区，Java（以及大多数编程语言）提供了同步机制。
当一个线程试图访问一个临界区时，它将使用一种同步机制来查看是不是已经有其他线程进入临界区。
如果没有其他线程进入临界区，它就可以进入临界区；如果已经有线程进入了临界区，他就被同步机制挂起，直到进入的线程离开这个临界区。
如果在等待进入临界区的线程不止一个，JVM 会选择其中一个，其余的将继续等待。

下面将讲解如何使用 Java 语言提供的两种基本同步机制：

- synchronized 关键字机制

- Lock 接口及其实现机制


### 目录导航

- [使用 synchronized 实现同步](#使用synchronized实现同步)


### [使用synchronized实现同步](bts_01/Parking.java "查看示例")

分类：

- 使用 synchronized 同步实例方法

- 使用 synchronized 同步静态方法

- 使用 synchronized 同步代码块

    - 同步单一对象锁，使用 `this` 指代正在执行方法所属的对象
    
    - 同步类锁，使用 `*.class`
    
    - 使用非属性依赖，即使用其他对象

每一个用 synchronized 关键字声明的方法都是临界区。在同一时间内只允许一个执行线程访问。

注意：如果一个线程访问同步实例方法，另一个线程访问同步静态方法，而这两个方法都改变了相同的数据，可能会出现数据不一致的错误。（[示例](bts_01/SyncMethods.java)）

synchronized 是可重入的。即当一个线程在访问一个对象的同步方法块时，它还可以调用这个对象的其他同步方法，也包含正在执行的方法，而不必再次获取这个方法的访问权。

通过使用 synchronized 保护代码块（而不是整个方法），以获得更好的性能。























